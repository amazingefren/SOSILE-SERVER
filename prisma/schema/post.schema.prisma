// https://ftpdocs.broadcom.com/cadocs/0/e002961e.pdf
model Post {
  id            Int       @id @default(autoincrement())
  content       String
  date          DateTime  @default(now())
  updated       DateTime  @updatedAt

  history       PostHistory[]

  likes         User[]  @relation("likedBy")

  // CURRENTLY THIS IS DOING 1->1->1
  // SO REPLY HAS 1 PARENT
  // AND REPLY HAS 1 REPLY THAT HAS 1 REPLY
  replies       PostReply[] @relation(name: "reply")
  parents       PostReply[] @relation(name: "parent")
  isReply       Boolean     @default(false)

  author        User    @relation(fields: [authorId], references: [id])
  authorId      Int
}

model PostHistory {
  id        Int       @id @default(autoincrement())
  content   String
  date      DateTime 

  parent    Post?   @relation(fields: [parentId], references: [id])
  parentId  Int?
}

model PostReply {
  reply     Post @relation(name: "parent", fields:[replyId], references:[id])
  replyId   Int
  replyTo    Post @relation(name: "reply", fields:[replyToId], references:[id])
  replyToId  Int

  @@id([replyId, replyToId])
}
